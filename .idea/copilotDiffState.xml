<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/commande-service/src/main/java/com/example/demo/client/ProduitClient.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/commande-service/src/main/java/com/example/demo/client/ProduitClient.java" />
              <option name="updatedContent" value="package com.example.demo.client;&#10;&#10;import com.example.demo.model.Produit;&#10;import org.springframework.cloud.openfeign.FeignClient;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;&#10;@FeignClient(name = &quot;produit&quot;)&#10;public interface ProduitClient {&#10;    &#10;    @GetMapping(&quot;/produits/{id}&quot;)&#10;    Produit getProduitById(@PathVariable(&quot;id&quot;) Long id);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/commande-service/src/main/java/com/example/demo/controller/CommandeController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/commande-service/src/main/java/com/example/demo/controller/CommandeController.java" />
              <option name="originalContent" value="package com.example.demo.controller;&#10;&#10;import com.example.demo.entities.Commande;&#10;import com.example.demo.repository.CommandeRepository;&#10;import lombok.AllArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RestController;&#10;&#10;import java.util.List;&#10;&#10;@AllArgsConstructor&#10;@RestController&#10;public class CommandeController {&#10;    private CommandeRepository commandeRepository;&#10;&#10;    @GetMapping(&quot;/commandes&quot;)&#10;    public List&lt;Commande&gt; all() {&#10;        return commandeRepository.findAll();&#10;    }&#10;&#10;    @GetMapping(&quot;/commandes/{id}&quot;)&#10;    public Commande get(@PathVariable Long id) {&#10;        return commandeRepository.findById(id).orElse(null);&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.demo.controller;&#10;&#10;import com.example.demo.entities.Commande;&#10;import com.example.demo.feign.ClientRestClient;&#10;import com.example.demo.feign.ProduitRestClient;&#10;import com.example.demo.model.Client;&#10;import com.example.demo.model.Produit;&#10;import com.example.demo.repository.CommandeRepository;&#10;import com.example.demo.repository.ProductItemRepository;&#10;import lombok.AllArgsConstructor;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RestController;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@AllArgsConstructor&#10;public class CommandeController {&#10;    private CommandeRepository commandeRepository;&#10;    private ProductItemRepository productItemRepository;&#10;    private ClientRestClient clientRestClient;&#10;    private ProduitRestClient produitRestClient;&#10;&#10;    @GetMapping(&quot;/commandes&quot;)&#10;    public List&lt;Commande&gt; all() {&#10;        return commandeRepository.findAll();&#10;    }&#10;&#10;    @GetMapping(&quot;/commandes/{id}&quot;)&#10;    public Commande getCommandeDetails(@PathVariable Long id) {&#10;        // 1. Recuperer les donnees brutes de la commande depuis la base locale&#10;        Commande commande = commandeRepository.findById(id).orElse(null);&#10;        if (commande == null) return null;&#10;&#10;        // 2. Enrichir la commande en appelant le client-service via Feign&#10;        Client client = clientRestClient.findClientById(commande.getIdClient());&#10;        commande.setClient(client);&#10;&#10;        // 3. Enrichir chaque article en appelant le produit-service&#10;        commande.getProductItems().forEach(pi -&gt; {&#10;            Produit produit = produitRestClient.findProduitById(pi.getIdProduit());&#10;            pi.setProduit(produit);&#10;        });&#10;&#10;        // 4. Retourner l'objet de donnees completes et aggregees&#10;        return commande;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>